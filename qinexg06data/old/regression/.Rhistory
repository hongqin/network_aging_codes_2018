tb.wm = read.table( "natural.winmodest.out"):
;
tb.wm = read.table( "natural.winmodest.out");
tb.wm = read.table( "natural.winmodest.out", header=T);
tb.wm
ls();
library(ade4)
tb.all = read.table( "merged.tab", header=T);
expt.name = as.character(tb.all$expt);
strain = expt.name;
for( i in 1:length(expt.name)) {
   strain[i] = unlist( strsplit( expt.name[i], "\\.") ) [1];
}
strain;
plot( avg~a, data=tb.all, xlab="I0", ylab="Average RLS",
 main= "Average lifespan ~ I0, merged, WinModest, 042405 " );
 
scatterutil.eti( tb.all$a, tb.all$avg, strain, 0.5 );
#arrows( tb.all$a_low, tb.all$avg, tb.all$a_up, tb.all$avg, col="green", angle=90, lty=8, length=0.1,code=3  );
# 95% confidence level is too stringent
plot( avg~b, data=tb.all, xlab="G", ylab="Average RLS",
 main= "Average lifespan ~ G, merged, WinModest, 042405 " );
scatterutil.eti( tb.all$b, tb.all$avg, strain, 0.5 );
tb.all[2,]=NA;
rls.avg.nat = mean( tb.all$avg );
m.a = lm( avg ~ a, data=tb.all );
summary(m.a);
a.avg = mean( tb.all$a );
m.b = lm( avg ~ b, data=tb.all );
summary(m.b);
b.avg = mean( tb.all$b );
rls.avg.nat
tb.all[2,]=NA;
rls.avg.nat = mean( tb.all$avg, na.rm=T );
m.a = lm( avg ~ a, data=tb.all );
summary(m.a);
a.avg = mean( tb.all$a, na.rm=T );
m.b = lm( avg ~ b, data=tb.all );
summary(m.b);
b.avg = mean( tb.all$b, na.rm=T  );
b.avg
a.avg
rls.avg.nat
sd( tb.all$avg, na.rm=T);
sd( tb.all$a, na.rm=T);
sd( tb.all$b, na.rm=T);
avg.predict <- function ( a, b ) {   log( log(2)*b/a + 1 )/b  }
x.a = seq(0, max(tb.all$a), 500);
help(seq)
x.a = seq(0, max(tb.all$a), length=500);
x.a = seq(0, max(tb.all$a, na.rm=T), length=500);
x.a
y.rls.a = avg.predict( x.a, b.avg);
y.rls.a
x.b = seq( 0.05, max(tb.all$b, na.rm=T), length=500);
y.rls.b = avg.predict( a.avg, x.b );
y.rls.b
plot( avg~a, data=tb.all, xlab="I0", ylab="Average RLS",
 main= "Average lifespan ~ I0, merged, WinModest, 042405 " ); 
scatterutil.eti( tb.all$a, tb.all$avg, strain, 0.5 );
abline( m.a );
plot( avg~a, data=tb.all, xlab="I0", ylab="Average RLS",
 main= "Average lifespan ~ I0, merged, WinModest, 042405 " ); 
scatterutil.eti( tb.all$a, tb.all$avg, strain, 0.5 );
abline( m.a, col="red" );
plot( avg~a, data=tb.all, xlab="I0", ylab="Average RLS",
 main= "Average lifespan ~ I0, merged, WinModest, 042405 " ); 
scatterutil.eti( tb.all$a, tb.all$avg, strain, 0.5 );
abline( m.a, col="red", ltype=2 );
####################################3
### redo plot with prediction and regression
plot( avg~a, data=tb.all, xlab="I0", ylab="Average RLS",
 main= "Average lifespan ~ I0, merged, WinModest, 042405 " ); 
scatterutil.eti( tb.all$a, tb.all$avg, strain, 0.5 );
abline( m.a, col="red", ltype=2 );
plot( avg~a, data=tb.all, xlab="I0", ylab="Average RLS",
 main= "Average lifespan ~ I0, merged, WinModest, 042405 " ); 
scatterutil.eti( tb.all$a, tb.all$avg, strain, 0.5 );
abline( m.a, col="red", lty=2 );
lines( x.a, y.rls.a, col="blue", lty=2);
plot( avg~b, data=tb.all, xlab="G", ylab="Average RLS",
 main= "Average lifespan ~ G, merged, WinModest, 042405 " );
scatterutil.eti( tb.all$b, tb.all$avg, strain, 0.5 );
abline( m.b, col="red", lty=2 );
lines( x.b, y.rls.b, col="blue", lty=2);
tb=read.table("merged.rls.tab",header=T);
tb=read.table("merged.tab",header=T);
tb
tb[2,] = NA
tb
m.li = lm( tb$avg ~ tb$a );
summary( m.li );
m.li
r.li = 0.25
r.li = sqrt( 0.25)
r.li
m.lg = lm (tb$avg ~ tb$b);
summary( m.lg)
r.lg = sqrt( 0.3495)
r.lg
m.ig = lm ( tb$a ~ tb$b );
summary( m.ig)
tb
m.ig
m.ig = lm ( tb$a ~ tb$b );
summary( m.ig );
tb
tb = read.table ("merged.tab", header=T);
tb
tb [2,] = NA
tb
a = tb$a
a
b = tb$b
life = tb$avg
a
b
life
cbind( a,b,life);
m.la = lm( life ~ a );
summary( m.la)
tb
a[11] = 0.002
m.la = lm( life ~ a );
summary(m.la)
a = tb$a
a
tb
a
tb
a[7] = 0.003
a[1]=0.003
m.la = lm( life ~ a );
summary(m.la)
a = tb$a
tb
a
life
a2 = c( 0.0035, a );
life2= c(25, life);
a2
life2
m2 = lm( life2 ~ a2); summary(m2);
a2
tb
a[6]=NA
life[6]=NA
m1 = lm(life ~ a ); summary( m1 );
tb = read.table( "merged.tab", header=T);
tb
tb[2,]=NA
tb
a2 = c( 0.0035, tb$a ); life2 = c( 25, tb$avg );
m2 = lm( life2 ~ a2 ); summary(m2);
ls();
tb
a2 = c( 0.0044, tb$a); life2 = c(25, tb$avg);
m2 = lm( life2 ~ a2); summary(m2);
m2
summary(m2)
ls()
a
b
tb.all
str(tb.all);
tb.all[1,]
a = tb.all$a
b = tb.all$b
rls = tb.all$avg
m1 = lm(rls~b); summary(m1);
m2 = lm(rls~a); summary(m2);
a2 = c( a, 0.00767);
b2 = c(b, 0.09)
rls = (rls, 23.86);
rls = c(rls, 23.86);
m2 = lm(rls~a); summary(m2);
m2 = lm(rls~a2); summary(m2);
mb = lm(rls~b2); summary(mb);
b2 = c(b, 0.11)
mb = lm(rls~b2); summary(mb);
rls
rls[15]
rls[15] = 22.7
mb = lm(rls~b2); summary(mb);
ls();
tb.all
m = lm( avg ~ a + b, data=tb.all);
m
summary(m)
ma = lm( avg ~ a , data=tb.all);
summary(ma)
mb = lm( avg ~ b , data=tb.all);
summary(mb)l;
summary(mb)l
summary(mb)
anova(ma);
anova(ma,mb,m);
anova(m,ma,mb)
anova(m,mb,ma)
ab = lm( a ~ b, data=tb.all); summary(ab);
anova(m,mb)
anova(m,ma)
anova(m)
m
ma
mb
ls();
m2 = lm( avg~ a + b + a/b, data=tb.all);
summary(m2);
summary(m)
